<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Model Profile | Toast Talent</title>
  <link rel="stylesheet" href="style.css" />
  
  <!-- Google Sign-In Script -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script>
    function handleCredentialResponse(response) {
      console.log("Encoded JWT ID token: " + response.credential);
      // Here you can send the token to your backend for verification
    } 

    window.onload = function () {
      google.accounts.id.initialize({
        client_id: "YOUR_GOOGLE_CLIENT_ID", // Replace with your Google Client ID
        callback: handleCredentialResponse
      });
      google.accounts.id.renderButton(
        document.getElementById("g_id_signin"),
        { theme: "outline", size: "large" } // Customize button style if needed
      );
      google.accounts.id.prompt(); // Show One Tap prompt automatically
    }
  </script>
</head>
<body>
  <nav class="navbar">
    <div class="nav-content">
      <a href="index.html" class="nav-logo">
        <img src="images/Toast Logo.jpeg" alt="Toast Talent Logo" onerror="this.onerror=null;this.src='images/default.jpg';">
      </a>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="models.html" class="active">Models</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </div>
  </nav>

  <main class="profile-container">
    <div id="profileContent"></div>
    <!-- Google Sign-In Button -->
    <div id="g_id_signin" style="margin-top:20px; text-align:center;"></div>
  </main>

  <div id="lightbox" class="lightbox" aria-hidden="true">
    <span class="close-lightbox">&times;</span>
    <img class="lightbox-img" src="" alt="">
  </div>

  <footer>&copy; 2025 Toast Talent Modeling Agency</footer>

<script>
const urlParams = new URLSearchParams(window.location.search);
const modelId = urlParams.get("id");

fetch("models.json")
  .then(res => res.json())
  .then(data => {
    // data is an array in your file, so use data.find(...)
    const model = data.find(m => m.id == modelId);
    if (!model) {
      document.getElementById("profileContent").innerHTML = "<p>Model not found.</p>";
      return;
    }

    const galleryHtml = model.images && model.images.length > 0
      ? model.images.map((img,i) => `<img src="${img}" alt="${model.name} gallery image ${i+1}" class="profile-gallery-img" onerror="this.onerror=null;this.src='images/default.jpg';">`).join('')
      : "<p>No gallery images available.</p>";

    document.getElementById("profileContent").innerHTML = `
      <h1 class="model-name">${model.name}</h1>
      <p><span class="profile-label">Age:</span> ${model.age}</p>
      <p><span class="profile-label">Height:</span> ${model.height}</p>
      <h2>Gallery</h2>
      <p class="gallery-note">ðŸ’¡ Click any picture to view it full size</p>
      <div class="profile-gallery">${galleryHtml}</div>
    `;

    const lightbox = document.getElementById("lightbox");
    const lightboxImg = document.querySelector(".lightbox-img");
    const closeBtn = document.querySelector(".close-lightbox");

    document.querySelectorAll(".profile-gallery-img").forEach(img => {
      img.addEventListener('click', () => {
        lightbox.style.display = 'flex';
        lightboxImg.src = img.src;
        lightbox.setAttribute('aria-hidden','false');
      });
    });

    closeBtn.addEventListener('click', ()=> {
      lightbox.style.display = 'none';
      lightbox.setAttribute('aria-hidden','true');
    });

    lightbox.addEventListener('click', e => {
      if (e.target === lightbox) {
        lightbox.style.display = 'none';
        lightbox.setAttribute('aria-hidden','true');
      }
    });
  })
  .catch(err => {
    console.error('Error loading models.json', err);
    document.getElementById("profileContent").innerHTML = "<p style='color:red;text-align:center;'>Error loading profile. Please try again later.</p>";
  });
</script>
</body>
</html>
