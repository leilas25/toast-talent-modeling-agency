<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Models | Toast Talent</title>
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <nav class="navbar">
    <div class="nav-content">
      <a href="/" class="nav-logo"><img src="/images/Toast Logo.jpeg" alt="Toast Talent"></a>
      <ul class="nav-links">
        <li><a href="/index.html">Home</a></li>
        <li><a href="/models.html" class="active">Models</a></li>
        <li><a href="/about.html">About</a></li>
      </ul>
    </div>
  </nav>

  <main class="models-gallery">
    <header class="models-hero">
      <h1>Discover Our Talent</h1>
      <p>Click any card to view model details.</p>
    </header>

    <section id="modelsGrid" class="models-grid" aria-live="polite" style="min-height:120px;">
      <p style="text-align:center; width:100%;">Loading modelsâ€¦</p>
    </section>
  </main>

  <footer>&copy; 2025 Toast Talent Modeling Agency</footer>

<script>
  const API_BASE = 'https://api.toasttalent.co.za';

  const grid = document.getElementById('modelsGrid');

  async function loadModels() {
    try {
      const res = await fetch(`${API_BASE}/api/models`, { cache: 'no-store' });
      if (!res.ok) throw new Error('API returned ' + res.status);
      const models = await res.json();
      render(models);
    } catch (err) {
      console.warn('API failed, falling back to local models.json', err);
      try {
        const r2 = await fetch('/models.json', { cache: 'no-store' });
        if (!r2.ok) throw new Error('Fallback not found');
        const models = await r2.json();
        render(models);
      } catch (err2) {
        grid.innerHTML = '<p style="color:red;text-align:center;">Could not load models right now.</p>';
      }
    }
  }

  function render(models) {
    if (!models || models.length === 0) {
      grid.innerHTML = '<p style="text-align:center;">No models available.</p>';
      return;
    }
    grid.innerHTML = models.map(m => `
      <div class="model-card" data-id="${m._id || m.id}">
        <img src="${(m.profilePicture || m.images?.[0]) || '/images/default.jpg'}" alt="${m.name || 'Model'}" onerror="this.src='/images/default.jpg'">
        <div class="model-name">${m.name || 'Unnamed'}</div>
      </div>
    `).join('');
  }

  loadModels();
</script>
</body>
</html>